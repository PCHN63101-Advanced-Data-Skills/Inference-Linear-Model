
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>NHST II: Test Statistics &#8212; Linear Models II: Statistical Inference</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/test.css?v=90b7ad94" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '4.null-hypothesis-testing-II';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="NHST III: Statistical Significance" href="5.null-hypothesis-testing-III.html" />
    <link rel="prev" title="NHST I: The Null Hypothesis" href="3.null-hypothesis-testing-I.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Linear Models II: Statistical Inference - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Linear Models II: Statistical Inference - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.purpose-of-inference.html">The Purpose of Statistical Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.estimation-uncertainty.html">Uncertainty in Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.null-hypothesis-testing-I.html">NHST I: The Null Hypothesis</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">NHST II: Test Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.null-hypothesis-testing-III.html">NHST III: Statistical Significance</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.controversy.html">The Controversy of NHST</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCHN63101-Advanced-Data-Skills/Inference-Linear-Model" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCHN63101-Advanced-Data-Skills/Inference-Linear-Model/issues/new?title=Issue%20on%20page%20%2F4.null-hypothesis-testing-II.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/4.null-hypothesis-testing-II.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>NHST II: Test Statistics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-logic-of-test-statistics">The Logic of Test Statistics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-z-statistic">The <span class="math notranslate nohighlight">\(z\)</span>-statistic</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-null-distribution-of-z">The Null Distribution of <span class="math notranslate nohighlight">\(z\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-the-variance">Estimating the Variance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-statistic">The <span class="math notranslate nohighlight">\(t\)</span>-statistic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-test-statistics">Other Test Statistics</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="nhst-ii-test-statistics">
<h1>NHST II: Test Statistics<a class="headerlink" href="#nhst-ii-test-statistics" title="Link to this heading">#</a></h1>
<p>We have now reached a point where most of the logic of NHST has been established. To review, we begin by determining what value our parameter of interest would have under the null hypothesis of no effect. We can then compare that value to the actual value we have calculated to produce a <em>difference</em> that we have called <span class="math notranslate nohighlight">\(\delta\)</span>. Using the theoretical sampling distribution of <span class="math notranslate nohighlight">\(\delta\)</span>, we can establish the probability of this value having occurred <em>if the null hypothesis were true</em>. The smaller this probability, the less compatible our data is with the proposed null value. If the probability gets small enough, we can take this as evidence <em>against</em> the null hypothesis, implying that the true effect in the population is <em>unlikely</em> to be the null value.</p>
<section id="the-logic-of-test-statistics">
<h2>The Logic of Test Statistics<a class="headerlink" href="#the-logic-of-test-statistics" title="Link to this heading">#</a></h2>
<p>Before we discuss more about calculating these probabilities, we first need to discuss some practical limitations of using the distribution of <span class="math notranslate nohighlight">\(\delta\)</span>:</p>
<ul class="simple">
<li><p>With our current method, we need to construct a new null distribution for every data analysis because the distribution of <span class="math notranslate nohighlight">\(\delta\)</span> depends upon both the units of our measurements and the standard error.</p></li>
<li><p>We cannot compare values of <span class="math notranslate nohighlight">\(\delta\)</span> across diffeerent studies, because <span class="math notranslate nohighlight">\(\delta\)</span> is only interpretable within the context of the current analysis.</p></li>
<li><p>The probabilities associated with <span class="math notranslate nohighlight">\(\delta\)</span> must also be calculated manually each time, due to the fact that the distribution changes.</p></li>
</ul>
<p>For all these reasons, it is typical to transform <span class="math notranslate nohighlight">\(\delta\)</span> into a standardised value known as a <em>test statistic</em>. In doing so, we are able to turn a messy and context-specific procedure into a universally interpretable process for inference.</p>
</section>
<section id="the-z-statistic">
<h2>The <span class="math notranslate nohighlight">\(z\)</span>-statistic<a class="headerlink" href="#the-z-statistic" title="Link to this heading">#</a></h2>
<p>The first method we can use to standardise <span class="math notranslate nohighlight">\(\delta\)</span> is to divide it by its <em>standard error</em>. This produces a value that we will call <span class="math notranslate nohighlight">\(z\)</span></p>
<div class="math notranslate nohighlight">
\[
z = \frac{\delta}{\sqrt{\text{Var}(\delta)}}.
\]</div>
<p>This <em>scales</em> <span class="math notranslate nohighlight">\(\delta\)</span> into units of standard error. We can think of this as the magnitude of <span class="math notranslate nohighlight">\(\delta\)</span>, expressed in terms of the number of standard errors the deviation represents. As an example, if <span class="math notranslate nohighlight">\(\delta = 6\)</span> and <span class="math notranslate nohighlight">\(\sqrt{\text{Var}(\delta)} = 3\)</span>, then <span class="math notranslate nohighlight">\(z = \frac{6}{3} = 2\)</span>. In this situation, the average deviation from 0 is 3, so a <span class="math notranslate nohighlight">\(\delta\)</span> of 6 represents 2 of those average deviations. The magnitude of <span class="math notranslate nohighlight">\(\delta\)</span> is therefore 2 standard errors away from 0. This is therefore a <em>standardised</em> quantity that can be compared and intepreted across studies. In our current example of testing a regression slope against 0, we therefore have</p>
<div class="math notranslate nohighlight">
\[
z = \frac{\delta}{\sqrt{\text{Var}(\delta)}} = \frac{\hat{\beta}_{1} - \beta_{1}^{(0)}}{\sqrt{\text{Var}\left(\hat{\beta}_{1} - \beta_{1}^{(0)}\right)}} = \frac{\hat{\beta}_{1}}{\text{SE}\left(\hat{\beta}_{1}\right)} = \frac{\hat{\beta}_{1}}{\sqrt{\frac{\sigma^{2}}{\sum{(x_{i} - \bar{x})^{2}}}}},
\]</div>
<p>where the denominator is often rearranged and written as</p>
<div class="math notranslate nohighlight">
\[
z = \frac{\hat{\beta}_{1}}{\sigma / \sqrt{\sum{(x_{i} - \bar{x})^{2}}}}.
\]</div>
<p>The larger <span class="math notranslate nohighlight">\(z\)</span> is, the larger <span class="math notranslate nohighlight">\(\delta\)</span> is, relative to its standard error. This is useful for interpretation, because the same value of <span class="math notranslate nohighlight">\(\delta\)</span> across different experiments may result in different values of <span class="math notranslate nohighlight">\(z\)</span>, depending upon the degree of uncertainty. The value of <span class="math notranslate nohighlight">\(z\)</span> therefore combines the <em>magnitude</em> of <span class="math notranslate nohighlight">\(\delta\)</span> with the <em>width</em> of its sampling distribution. For instance, <span class="math notranslate nohighlight">\(\delta = 5\)</span> would be interpreted very differently if the SE was 2 compared to 10. In the first case, the difference is 2.5 times the standard error whereas, in the second case, the difference is only 0.5 the standard error. This is despite <span class="math notranslate nohighlight">\(\delta\)</span> being the same in both cases.</p>
<section id="the-null-distribution-of-z">
<h3>The Null Distribution of <span class="math notranslate nohighlight">\(z\)</span><a class="headerlink" href="#the-null-distribution-of-z" title="Link to this heading">#</a></h3>
<p>Beyond changing the interpretation of <span class="math notranslate nohighlight">\(\delta\)</span>, conversion to a <span class="math notranslate nohighlight">\(z\)</span>-statistic also changes its distribution under the null. Importantly, in the expression for <span class="math notranslate nohighlight">\(z\)</span> above, we have used <span class="math notranslate nohighlight">\(\sigma^{2}\)</span> and <em>not</em> <span class="math notranslate nohighlight">\(\hat{\sigma}^{2}\)</span>. So this is based on knowing the population variance, which does not seem particularly useful. However, sometimes assumptions have to be made in order to make progress, so we will stick with this and then address it in more detail below.</p>
<p>The main utility in assuming <span class="math notranslate nohighlight">\(\sigma^{2}\)</span> is known is that the denominator of <span class="math notranslate nohighlight">\(z\)</span> become a <em>constant</em>. Given that the numerator is just <span class="math notranslate nohighlight">\(\hat{\beta}_{1}\)</span> and we known that this is normally distributed, all <span class="math notranslate nohighlight">\(z\)</span> is doing is dividing a normal random variable by a constant. This does not change the <em>shape</em> of the distribution, it only changes the units. The expected value does not change, but the standard error becomes<a class="footnote-reference brackets" href="#standnorm-foot" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
<div class="math notranslate nohighlight">
\[
\text{SE}\left(z\right) = \text{SE}\left(\frac{\delta}{\text{SE}(\delta)}\right) = \frac{\text{SE}(\delta)}{\text{SE}(\delta)} = 1.
\]</div>
<p>From this, the distribution of <span class="math notranslate nohighlight">\(z\)</span> must be</p>
<div class="math notranslate nohighlight">
\[
z \sim \mathcal{N}\left(0,1\right),
\]</div>
<p>which is known as a <em>standard normal distribution</em>.</p>
<p>We can see that this conversion works, irrespective of the scale of the original data, using an example in <code class="docutils literal notranslate"><span class="pre">R</span></code>. The output below shows 4 examples of generating some data using a random mean and a random standard deviation. This data is then <em>standardised</em> into a <span class="math notranslate nohighlight">\(z\)</span>-score and a histogram of the resultant distribution shown, with a standard normal curve on top.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">666</span><span class="p">)</span>

<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">){</span>
<span class="w">    </span><span class="n">rand.mu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">runif</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="o">=</span><span class="m">100</span><span class="p">)</span><span class="w">             </span><span class="c1"># Random mean</span>
<span class="w">    </span><span class="n">rand.sd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">runif</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="w">  </span><span class="n">max</span><span class="o">=</span><span class="m">50</span><span class="p">)</span><span class="w">              </span><span class="c1"># Random SD</span>
<span class="w">    </span><span class="n">rand.y</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="o">=</span><span class="n">rand.mu</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="o">=</span><span class="n">rand.sd</span><span class="p">)</span><span class="w"> </span><span class="c1"># Generate data</span>
<span class="w">    </span><span class="n">z.dist</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">rand.y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">rand.y</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">rand.y</span><span class="p">)</span><span class="w">  </span><span class="c1"># Standardise</span>
<span class="w">  </span>
<span class="w">    </span><span class="c1"># Histogram of z-transformed data</span>
<span class="w">    </span><span class="n">title</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">paste0</span><span class="p">(</span><span class="s">&quot;y ~ N(&quot;</span><span class="p">,</span><span class="nf">round</span><span class="p">(</span><span class="n">rand.mu</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="s">&quot;,&quot;</span><span class="p">,</span><span class="nf">round</span><span class="p">(</span><span class="n">rand.sd</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="s">&quot;)&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">hist</span><span class="p">(</span><span class="n">z.dist</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="n">probability</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.45</span><span class="p">),</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-4</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;skyblue&quot;</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1"># Add a standard normal curve</span>
<span class="w">    </span><span class="nf">curve</span><span class="p">(</span><span class="nf">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="o">=</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">  </span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/292c8c7e876f412a6775afe55e7b278c4d8dde6fad720ddcc16073a5dbd6d310.png"><img alt="_images/292c8c7e876f412a6775afe55e7b278c4d8dde6fad720ddcc16073a5dbd6d310.png" src="_images/292c8c7e876f412a6775afe55e7b278c4d8dde6fad720ddcc16073a5dbd6d310.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>The point of this is to show that, no matter the original units of our data, we can calculate a <span class="math notranslate nohighlight">\(z\)</span>-statistic that we <em>know</em> has a standard normal distribution under the null. So, rather than having to work out the distribution of <span class="math notranslate nohighlight">\(\delta\)</span> each time, we can just turn <span class="math notranslate nohighlight">\(\delta\)</span> into <span class="math notranslate nohighlight">\(z\)</span> and <em>work with a single distribution</em>. So, we get an easy to interpret metric of the magnitude of <span class="math notranslate nohighlight">\(\delta\)</span> and can pre-compute probabilities to be used with <em>any</em> dataset<a class="footnote-reference brackets" href="#prob-foot" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
</section>
<section id="estimating-the-variance">
<h3>Estimating the Variance<a class="headerlink" href="#estimating-the-variance" title="Link to this heading">#</a></h3>
<p>As mentioned above, the calculation of <span class="math notranslate nohighlight">\(z\)</span> depended upon knowing <span class="math notranslate nohighlight">\(\sigma^{2}\)</span>. However, in practise, we do not known <span class="math notranslate nohighlight">\(\sigma^{2}\)</span>. Instead, we have an <em>estimated</em> value, denoted <span class="math notranslate nohighlight">\(\hat{\sigma}^{2}\)</span>. So how does that change things? For our current example, we can plug the estimated variance into the standard error formula, like so</p>
<div class="math notranslate nohighlight">
\[
\widehat{\text{SE}}\left(\delta\right) = \sqrt{\widehat{\text{Var}}\left(\hat{\beta}_{1}\right)} = \sqrt{\frac{\hat{\sigma}^{2}}{(n-1)\sigma^{2}_{x}}},
\]</div>
<p>resulting in a value for the standard error of <span class="math notranslate nohighlight">\(\delta\)</span>. However, what we have done here is replaced the <em>constant</em> <span class="math notranslate nohighlight">\(\sigma^{2}\)</span> with the <em>random variable</em> <span class="math notranslate nohighlight">\(\hat{\sigma}^{2}\)</span>. In effect, we have <em>estimated</em> the variance of our estimate, meaning that our calculated standard error is now also a <em>random variable</em>. This means that we will be introducing additional randomness into the calculation of <span class="math notranslate nohighlight">\(z\)</span>. The denominator of the test statistic is no longer a constant that simple scales the distribution. Instead, we are now dividing a <em>random variable</em> by <em>another random variable</em>.</p>
<p>So what happens when we do this? Well, the denominator of <span class="math notranslate nohighlight">\(z\)</span> served to scale <span class="math notranslate nohighlight">\(\delta\)</span> into standard units.
However, the range of standardised values we get will change depending on how variable the denominator is. When the denominator is constant this is fixed, but when this value is <em>random</em> this range changes <em>dynamically</em>. So, rather than having a distribution with a fixed-width, you end up with a distribution that changes its width <em>dynamically</em>. How this width changes depends upon the precision of our estimated standard error. The <em>less</em> precise the estimate, the more we expect extreme value of <span class="math notranslate nohighlight">\(z\)</span> to occur. This is because we will get more <em>underestimates</em> and more <em>overestimates</em> of the true value. This will be reflected in a null distribution that is <em>wider</em> than a standard normal.</p>
<div class="warning admonition">
<p class="admonition-title">Why Does This Matter?</p>
<p>The ramifications of having a null distribution that is <em>wider</em> than we think is that our calculated probabilities will be <em>wrong</em>. If we were to use a standard normal distribution to calculate probabilities when <span class="math notranslate nohighlight">\(n\)</span> is small, then the probabilies of extreme values would be <em>too small</em>. If we calculate a large discrepancy from the null, this would then appear <em>rarer</em> than it actually is and we would be overstating how incompatible our data are with the null hypothesis. In other words, we may well reach the <em>wrong conclusion</em>.</p>
</div>
<p>So what governs the precision of this estimate (and thus the width of the null distribution)? As we saw earlier with the samplimg distribution of <span class="math notranslate nohighlight">\(\beta_{1}\)</span>, this is governed by the <em>sample size</em>. We can illustrate this using some simulations in <code class="docutils literal notranslate"><span class="pre">R</span></code>. The output below shows the null distribution of <span class="math notranslate nohighlight">\(z\)</span> when the SE is estimated (<em>left</em> column) and when the SE is known (<em>right</em> column). The empirical distribution from the simulations is shown as a solid line, with the theoretical standard normal distribution shown as a dashed line. When the sample size is <em>small</em> and the SE is <em>estimated</em>, we can see that the empirical distribution is <em>wider</em> than a standard normal. This discrepancy decreases as <span class="math notranslate nohighlight">\(n\)</span> gets larger. However, when the SE is <em>known</em>, the standard normal fits, irrespective of the sample size.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>

<span class="c1"># Sample sizes to test</span>
<span class="n">sample.sizes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">20</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">500</span><span class="p">)</span>
<span class="n">n.sims</span><span class="w">       </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">10000</span>
<span class="n">true.sd</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span>
<span class="n">mu</span><span class="w">           </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span>

<span class="c1"># Set up plotting area: rows = sample sizes, 2 columns (estimated vs known SE)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">sample.sizes</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">mgp</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">0.6</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>

<span class="nf">for </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">sample.sizes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="n">z.est</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">n.sims</span><span class="p">)</span><span class="w">  </span>
<span class="w">     </span><span class="n">z.known</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">n.sims</span><span class="p">)</span><span class="w">  </span>
<span class="w">  </span>
<span class="w">     </span><span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n.sims</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1"># Generate data</span>
<span class="w">          </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="o">=</span><span class="n">true.sd</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">          </span><span class="c1"># Test statistics</span>
<span class="w">          </span><span class="n">z.est</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="nf">sd</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w">   </span><span class="o">/</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="w"> </span><span class="c1"># estimated</span>
<span class="w">          </span><span class="n">z.known</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">true.sd</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="w"> </span><span class="c1"># known</span>
<span class="w">     </span><span class="p">}</span>
<span class="w">  </span>
<span class="w">     </span><span class="c1"># Density estimates</span>
<span class="w">     </span><span class="n">d.est</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">density</span><span class="p">(</span><span class="n">z.est</span><span class="p">)</span>
<span class="w">     </span><span class="n">d.known</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">density</span><span class="p">(</span><span class="n">z.known</span><span class="p">)</span>
<span class="w"> </span>
<span class="w">     </span><span class="c1">## --- LEFT: Estimated SE ---</span>
<span class="w">     </span><span class="nf">plot</span><span class="p">(</span><span class="n">d.est</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;n =&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;| Estimated SE&quot;</span><span class="p">),</span>
<span class="w">          </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-4</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.45</span><span class="p">))</span>
<span class="w">  </span>
<span class="w">     </span><span class="nf">curve</span><span class="p">(</span><span class="nf">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">  </span>
<span class="w">     </span><span class="c1">## --- RIGHT: Known SE ---</span>
<span class="w">     </span><span class="nf">plot</span><span class="p">(</span><span class="n">d.known</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;n =&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;| Known SE&quot;</span><span class="p">),</span>
<span class="w">          </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-4</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.45</span><span class="p">))</span>
<span class="w">  </span>
<span class="w">     </span><span class="nf">curve</span><span class="p">(</span><span class="nf">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/ad1c3aaf55fe1703403f05f0c8e09284a435db2bd164b6f247e6830339c59f30.png"><img alt="_images/ad1c3aaf55fe1703403f05f0c8e09284a435db2bd164b6f247e6830339c59f30.png" src="_images/ad1c3aaf55fe1703403f05f0c8e09284a435db2bd164b6f247e6830339c59f30.png" style="width: 420px; height: 840px;" /></a>
</div>
</div>
<div class="warning admonition">
<p class="admonition-title">Implications for Sample Size</p>
<p>Be aware that although the plots above may imply that everything is fine so long as we use a sample size of 50 or more, the scaling of the plots actually hides the truth. Although we cannot see it from such a zoomed-out perspective, if we were to rescale the plots so we can see the tails close up, a discrepancy between the empirical and theoretical distributions would still exist. As <span class="math notranslate nohighlight">\(n\)</span> increases, the discrepancy will get smaller and smaller, but this is not the same as saying that there is <em>no</em> difference.</p>
</div>
</section>
</section>
<section id="the-t-statistic">
<h2>The <span class="math notranslate nohighlight">\(t\)</span>-statistic<a class="headerlink" href="#the-t-statistic" title="Link to this heading">#</a></h2>
<p>Because of the difference between using the true standard error and an estimate of the standard error, when we divide <span class="math notranslate nohighlight">\(\delta\)</span> by an <em>estimated</em> value we call the resultant statistic a <span class="math notranslate nohighlight">\(t\)</span>, rather than <span class="math notranslate nohighlight">\(z\)</span><a class="footnote-reference brackets" href="#studentz-foot" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p>
<div class="math notranslate nohighlight">
\[
t = \frac{\delta}{\sqrt{\widehat{\text{Var}}\left(\delta\right)}},
\]</div>
<p>which we can rewrite for our current example as</p>
<div class="math notranslate nohighlight">
\[
t = \frac{\hat{\beta}_{1}}{\hat{\sigma} / \sqrt{\sum{(x_{i} - \bar{x})^{2}}}},
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[
t = \frac{\hat{\beta}_{1}}{\hat{\sigma} / \sqrt{(n-1)\sigma^{2}_{x}}}.
\]</div>
<p>The corresponding null distribution for this <span class="math notranslate nohighlight">\(t\)</span>-statistic is, unsurprisingly, known as the <span class="math notranslate nohighlight">\(t\)</span>-distribution. As discussed above, given the uncertainty in the estimation of the denominator of the <span class="math notranslate nohighlight">\(t\)</span>-statistic, the <span class="math notranslate nohighlight">\(t\)</span>-distribution is able to dynamically reshape its width. This is achieved using a single parameter denoted <span class="math notranslate nohighlight">\(\nu\)</span>, more commonly known as the <em>degrees of freedom</em>. The value of <span class="math notranslate nohighlight">\(\nu\)</span> is directly informed by the sampling distribution of <span class="math notranslate nohighlight">\(\hat{\sigma}^{2}\)</span>. This is a bit complicated, but the only element that really matters is that this distribution reflects the uncertainty in estimation due to the sample size and is the part of the denominator that influences the width of the <span class="math notranslate nohighlight">\(t\)</span>-distribution. As illustrated below, for small values of <span class="math notranslate nohighlight">\(\nu\)</span> the <span class="math notranslate nohighlight">\(t\)</span>-distribution is wider and fatter than a standard normal. As <span class="math notranslate nohighlight">\(\nu\)</span> grows, the width shrinks and the <span class="math notranslate nohighlight">\(t\)</span>-distribution approaches a standard normal.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the x-axis range</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-4</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">)</span>

<span class="c1"># Define degrees of freedom to compare</span>
<span class="n">dfs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">)</span>

<span class="c1"># Set up plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nf">dt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.4</span><span class="p">),</span>
<span class="w">     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;t value&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Density&quot;</span><span class="p">,</span>
<span class="w">     </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;t-Distributions with Varying Degrees of Freedom&quot;</span><span class="p">)</span>

<span class="c1"># Define a color palette</span>
<span class="n">colors</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rainbow</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">dfs</span><span class="p">))</span>

<span class="c1"># Add lines for each t-distribution</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">dfs</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">lines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nf">dt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfs</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Add standard normal distribution for reference</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nf">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>

<span class="c1"># Add legend</span>
<span class="n">labels</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">paste0</span><span class="p">(</span><span class="s">&quot;nu == &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dfs</span><span class="p">)</span>
<span class="nf">legend</span><span class="p">(</span><span class="s">&quot;topright&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">      </span><span class="n">legend</span><span class="o">=</span><span class="nf">parse</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">labels</span><span class="p">),</span>
<span class="w">      </span><span class="n">col</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span><span class="w"> </span>
<span class="w">      </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span>
<span class="w">      </span><span class="n">bty</span><span class="o">=</span><span class="s">&quot;n&quot;</span><span class="p">)</span>

<span class="nf">legend</span><span class="p">(</span><span class="s">&quot;topleft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Standard Normal&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;n&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/7b72217719f23315225ba2d85f1c0642a0fd2c68afc2212009067783ee515fea.png"><img alt="_images/7b72217719f23315225ba2d85f1c0642a0fd2c68afc2212009067783ee515fea.png" src="_images/7b72217719f23315225ba2d85f1c0642a0fd2c68afc2212009067783ee515fea.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Student and the History of the <span class="math notranslate nohighlight">\(t\)</span>-statistic</p>
<p>The devlopment of the <span class="math notranslate nohighlight">\(t\)</span>-statistic is an interesting part of the history of modern statistics. The additional uncertainty added by using an estimate of the variance in small samples was not appreciated by statistians before a seminal publication by Student in 1908. Prior to this, statisticans would just use <span class="math notranslate nohighlight">\(z\)</span>-statistics and assume that the estimate of the variance could just be used as a close approximation of the population value. The paper titled <a class="reference external" href="https://www.jstor.org/stable/2331554">The Probable Error of a Mean</a> changed this thinking and introduced the world to the concept of the <span class="math notranslate nohighlight">\(t\)</span>-statistic and the <span class="math notranslate nohighlight">\(t\)</span>-distribution. The author was named <a class="reference external" href="https://en.wikipedia.org/wiki/William_Sealy_Gosset">William Sealy Gosset</a>, who was a statistician working for Guinness. However, due to previous disclosures of trade secrets through scientific publication, Guinness only allowed their staff to publish on condition that they did not mention:</p>
<ol class="arabic simple">
<li><p>Beer</p></li>
<li><p>Guinness</p></li>
<li><p>Their own surname</p></li>
</ol>
<p>As such, Gosset published his work on the <span class="math notranslate nohighlight">\(t\)</span>-distribution under the pseudonym Student. Because of this, the null distribution is still often referred to as Students <span class="math notranslate nohighlight">\(t\)</span>-distribution. Unfortunately, Gossets work fell largely on deaf ears until Fisher realised the usefulness of these results when developing his own methods several years later. Indeed, it was Fisher who, in a <a class="reference external" href="https://www.jstor.org/stable/2683142?origin=crossref">series of letters to Gosset</a>, corrected the derivation of the <span class="math notranslate nohighlight">\(t\)</span>-distribution by suggesting the use of the <em>degrees of freedom</em>, not the total sample size (as Gosset originally thought). This is an interesting historical point as it shows that the concept of degrees of freedom were not intuitive for statisticians and, in fact, were quite a controversial idea when <a class="reference external" href="https://www.jstor.org/stable/2340521?seq=1">first introduced</a> by Fisher.</p>
</div>
</section>
<section id="other-test-statistics">
<h2>Other Test Statistics<a class="headerlink" href="#other-test-statistics" title="Link to this heading">#</a></h2>
<p>There are many more test statistics in the world beyond the <span class="math notranslate nohighlight">\(z\)</span>-statistic and the <span class="math notranslate nohighlight">\(t\)</span>-statistic. As we move forward on this course, we will see other test statistics introduced. In all cases, the logic of using the statistic is the same. Whatever our null hypothesis may be, we want to place the calculated discrepancy from the null on a standardised scale that can be understood by anyone, irrespective of the original units of the data. Ideally, the null distribution of this statistic should also be dynamic to reflect uncertainty in the estimation of the standard error in small samples. However, if this is not possible, then we can still use statistics with a fixed null distribution and treat them as <em>asymptotically correct</em>. This means that the probabilities calculated from these distributions are correct, but only as <span class="math notranslate nohighlight">\(n\)</span> gets larger<a class="footnote-reference brackets" href="#infinitefoot" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>. This may seem a strange approach to take, however, we will see later on the course that there are some models where the concept of <em>degrees of freedom</em> causes problems because they become impossible to verify. This means that either an approximation is needed, or we have to abandon the concept entirely. We will discuss this more at a later date.</p>
<aside class="topic">
<p class="topic-title">What do you now know?</p>
<p>In this section, we have explored the second part of NHST in terms of defining a test-statistic. After reading this section, you should have a good sense of:</p>
<ul class="simple">
<li><p>Why it is more practical to turn our raw difference <span class="math notranslate nohighlight">\(\delta\)</span> in a standardised value, to allow for easier interpretation and, historically, easier calculation of probabilities.</p></li>
<li><p>The logic behind the <span class="math notranslate nohighlight">\(z\)</span>-statistic, which divides <span class="math notranslate nohighlight">\(\delta\)</span> by its standard error, rescaling <span class="math notranslate nohighlight">\(\delta\)</span> into standard error units.</p></li>
<li><p>The idea that this rescaling alters the distribution of <span class="math notranslate nohighlight">\(\delta\)</span> such that <span class="math notranslate nohighlight">\(z\)</span> follows a standard normal distribution under the null, irrespective of the original units of the data.</p></li>
<li><p>The idea that the <span class="math notranslate nohighlight">\(z\)</span>-statistic is based on assuming that <span class="math notranslate nohighlight">\(\sigma^{2}\)</span> is known, when in reality we almost always have to <em>estimate</em> this value.</p></li>
<li><p>The principle that when we <em>estimate</em> the variance (and thus estimate the standard error), the resultant test statistic is known as a <span class="math notranslate nohighlight">\(t\)</span>-statistic and follows a <span class="math notranslate nohighlight">\(t\)</span>-distribution under the null.</p></li>
<li><p>The concept that the <span class="math notranslate nohighlight">\(t\)</span>-distribution is able to flexibly adapt to the uncertainty in the estimation of the standard error by altering its width, as governed by its <em>degrees of freedom</em>.</p></li>
</ul>
</aside>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="standnorm-foot" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>This derivation is missing some steps, so do not worry if there seem to be some leaps. In order to derive it fully you need use rules around variances for linear transformations and that is all way beyond the point here.</p>
</aside>
<aside class="footnote brackets" id="prob-foot" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Although these days probabilities can be calculated directly using computers, in the past tables of probabilities for the standard normal distribution were published in books so that working statisticians could use them. Part of the utility of a test statistic was to allow these methods to be used <em>practically</em>. Rather than calculating these values by hand, a statistician could convert things into a <em>known</em> value and then use the published tables to calculate a probability.</p>
</aside>
<aside class="footnote brackets" id="studentz-foot" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>This was value was originally called Students <span class="math notranslate nohighlight">\(z\)</span>-statistic, but the name was later changed to the <span class="math notranslate nohighlight">\(t\)</span>-statistic by Fisher.</p>
</aside>
<aside class="footnote brackets" id="infinitefoot" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p>Matematically, we would say in the limit, as <span class="math notranslate nohighlight">\(n\)</span> approaches infinity, written <span class="math notranslate nohighlight">\(n \rightarrow \infty\)</span>. Obviously, an infinite sample size is a silly thing to consider, however, this is just a mathematical vehicle for reaching results that hold as the sample size gets larger and larger. When using asymptotically correct null distributions, either a large sample size is needed, or additional caution is warranted in small samples.</p>
</aside>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3.null-hypothesis-testing-I.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">NHST I: The Null Hypothesis</p>
      </div>
    </a>
    <a class="right-next"
       href="5.null-hypothesis-testing-III.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">NHST III: Statistical Significance</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-logic-of-test-statistics">The Logic of Test Statistics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-z-statistic">The <span class="math notranslate nohighlight">\(z\)</span>-statistic</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-null-distribution-of-z">The Null Distribution of <span class="math notranslate nohighlight">\(z\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-the-variance">Estimating the Variance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-statistic">The <span class="math notranslate nohighlight">\(t\)</span>-statistic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-test-statistics">Other Test Statistics</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr George Farmer & Dr Martyn McFarquhar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>